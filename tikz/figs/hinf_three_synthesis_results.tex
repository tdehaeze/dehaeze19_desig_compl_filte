\setlength\fwidth{6.5cm}
\setlength\fheight{6cm}

\begin{tikzpicture}
  \begin{axis}[%
    width=1.0\fwidth,
    height=0.55\fheight,
    at={(0.0\fwidth, 0.45\fheight)},
    scale only axis,
    xmode=log,
    xmin=0.1,
    xmax=100,
    xticklabels={{}},
    xminorticks=true,
    ymode=log,
    ymin=0.0005,
    ymax=20,
    ytick={0.001, 0.01, 0.1, 1, 10},
    yminorticks=true,
    ylabel={Magnitude},
    xminorgrids,
    yminorgrids,
    legend columns=2,
    legend style={
      /tikz/column 2/.style={
        column sep=5pt,
      },
      at={(1,0)}, outer sep=2pt , anchor=south east, legend cell align=left, align=left, draw=black, nodes={scale=0.7, transform shape}
    },
    ]
    \addplot [color=mycolor1, dashed, line width=1.5pt]
    table [x=freqs, y=W1, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_weights.csv};
    \addlegendentry{${W_1}^{-1}$};
    \addplot [color=mycolor1, line width=1.5pt]
    table [x=freqs, y=H1, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};
    \addlegendentry{$H_1$};


    \addplot [color=mycolor2, dashed, line width=1.5pt]
    table [x=freqs, y=W2, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_weights.csv};
    \addlegendentry{${W_2}^{-1}$};
    \addplot [color=mycolor2, line width=1.5pt]
    table [x=freqs, y=H2, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};
    \addlegendentry{$H_2$};

    \addplot [color=mycolor3, dashed, line width=1.5pt]
    table [x=freqs, y=W3, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_weights.csv};
    \addlegendentry{${W_3}^{-1}$};
    \addplot [color=mycolor3, line width=1.5pt]
    table [x=freqs, y=H3, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};
    \addlegendentry{$H_3$};
  \end{axis}

  \begin{axis}[%
    width=1.0\fwidth,
    height=0.4\fheight,
    at={(0.0\fwidth, 0.0\fheight)},
    scale only axis,
    xmode=log,
    xmin=0.1,
    xmax=100,
    xminorticks=true,
    xlabel={Frequency [Hz]},
    ymin=-240,
    ymax=240,
    ytick={-180,  -90,    0,   90,  180},
    ylabel={Phase [deg]},
    xminorgrids,
    ]

    \addplot [color=mycolor1, line width=1.5pt]
    table [x=freqs, y=H1p, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};

    \addplot [color=mycolor2, line width=1.5pt]
    table [x=freqs, y=H2p, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};

    \addplot [color=mycolor3, line width=1.5pt]
    table [x=freqs, y=H3p, col sep=comma] {/home/thomas/Cloud/These/Papers/dehaeze19_desig_compl_filte/matlab/mat/hinf_three_results.csv};
  \end{axis}
\end{tikzpicture}
