#+TITLE: Complementary Filters Shaping\newline Using $\mathcal{H}_\infty$ Synthesis
:DRAWER:
#+AUTHOR:    Dehaeze Thomas
#+SUBTITLE:  Control System Working Group meeting
#+EMAIL:     dehaeze.thomas@gmail.com
#+DATE:      {{{time(%Y-%m-%d)}}}

#+DESCRIPTION: Complementary Filters Shaping Using H-Infinity Synthesis. Presentation during a Control System Working Group Meeting at LIGO.
#+KEYWORDS:complementary filters, h-infinity, sensor fusion
#+LANGUAGE: en

#+STARTUP: beamer

#+LaTeX_CLASS: clean-beamer
#+LaTeX_CLASS_OPTIONS: [t]

#+OPTIONS: H:2
#+OPTIONS: num:t toc:nil ::t |:t ^:{} -:t f:t *:t <:t

#+SELECT_TAGS: export
#+EXCLUDE_TAGS: noexport

#+latex_header_extra: \beamertemplatenavigationsymbolsempty
#+latex_header_extra: \addtobeamertemplate{navigation symbols}{}{%
#+latex_header_extra:     \usebeamerfont{footline}%
#+latex_header_extra:     \usebeamercolor[fg]{footline}%
#+latex_header_extra:     \hspace{1em}%
#+latex_header_extra:     \insertframenumber/\inserttotalframenumber
#+latex_header_extra: }
#+latex_header_extra: \setbeamertemplate{itemize items}[circle]
#+latex_header_extra: \usefonttheme[onlymath]{serif}
#+latex_header_extra: \definecolor{mycolor1}{RGB}{79,115,193}
#+latex_header_extra: \definecolor{mycolor2}{RGB}{213,91,53}
:END:

* Complementary Filters Shaping
** Sensor Fusion Architecture - Noise Filtering
\vspace{-1em}
*** Schematic                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.45
:END:

\vspace{-1em}
#+attr_latex: :width 1.1\linewidth
[[file:figs/fusion_super_sensor.pdf]]

*** Equations                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.55
:END:

\begin{equation*}
  \hat{x} = \left(G_1 H_1 + G_2 H_2\right) x + H_1 n_1 + H_2 n_2
\end{equation*}

**** Complementary Property                                       :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:
\begin{equation*}
  H_1(s) + H_2(s) = 1
\end{equation*}

*** Full Analysis                                         :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\vspace{0.5em}
Let's first consider *Perfectly Known Sensor Dynamics*:
\begin{equation*}
  G_1(s) = G_2(s) = 1 \Longrightarrow \hat{x} = x + H_1 n_1 + H_2 n_2
\end{equation*}

**** PSD of the Super Sensor's noise                              :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{ams nodisplayskip}
:END:
\begin{equation*}
  \Phi_{\delta x} = \left|H_1\right|^2 \Phi_{n_1} + \left|H_2\right|^2 \Phi_{n_2} \Longrightarrow \text{depends on filters' norm}
\end{equation*}

** Sensor Fusion Architecture - Robustness
*** Schematic                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\vspace{-2em}
#+attr_latex: :width 1.1\linewidth
[[file:figs/sensor_fusion_dynamic_uncertainty.pdf]]

*** Equations                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:

*Dynamic Uncertainty*:
\begin{gather*}
  G_i^\prime(s) = G_i(s) [1 + w_i(s)\Delta_i(s)],\\
  \quad \forall\Delta_i, \|\Delta_i\|_\infty < 1
\end{gather*}

*Super Sensor Dynamics*:
\begin{equation*}
  \frac{\hat{x}}{x} = 1 + w_1 H_1 \Delta_1 + w_2 H_2 \Delta_2
\end{equation*}

*** Full Analysis                                         :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:

\vspace{0.5em}
**** Limit the Super Sensor Dynamic uncertainty                   :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:
Design $H_1(s)$ and $H_2(s)$ such that:
\begin{equation*}
  \begin{aligned}
                    & \left|w_1 H_1 \Delta_1\right| + \left|w_2 H_2 \Delta_2\right| \le \epsilon \quad \forall\omega,\ \forall \Delta_1, \forall \Delta_2\\
    \Leftrightarrow & \left|w_1 H_1\right| + \left|w_2 H_2\right| \le \epsilon \quad \forall\omega \\
    \Longrightarrow & \text{ depends on the filters' norm} \\
  \end{aligned}
\end{equation*}

** Shaping of Complementary Filters using $\mathcal{H}_\infty$ synthesis
\vspace{-1em}
*** Equations                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
**** Design Objective                                             :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{ams nodisplayskip}
:END:
\begin{gather*}
  H_1(s) + H_2(s) = 1 \\
  |H_1(j\omega)| \le \frac{1}{|W_1(j\omega)|} \quad \forall\omega \\
  |H_2(j\omega)| \le \frac{1}{|W_2(j\omega)|} \quad \forall\omega
\end{gather*}

**** @@latex:@@                                                   :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:

$W_1(s)$ and $W_2(s)$ are proper, stable and minimum phase transfer functions

*** Schematic                                                       :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\vspace{-3em}
#+attr_latex: :width \linewidth
[[file:figs/h_infinity_robust_fusion.pdf]]

**** $\mathcal{H}_\infty$ Synthesis                               :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:
Find $H_2(s)$ such that:
\begin{gather*}
  \left\|\begin{matrix} \left[1 - H_2(s)\right] W_1(s) \\ H_2(s) W_2(s) \end{matrix}\right\|_\infty \le 1 \\
  H_1(s) \triangleq 1 - H_2(s)
\end{gather*}

** Validation of the proposed synthesis method
#+attr_latex: :width 0.85\linewidth
[[file:figs/hinf_synthesis_results.pdf]]

** Complementary Filters Used at LIGO - Specifications
*** Specifications                                        :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
The specification are detailed in /Hua, W., Low frequency vibration isolation and alignment system for advanced LIGO (2005)/

*** Figure                                                :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:

#+attr_latex: :width 0.8\linewidth
[[file:figs/ligo_weights.pdf]]

*** Weighting Functions used                                       :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:

| $\tikz[baseline=-0.5ex]{\draw[color=mycolor1, line width=1.5pt](0,0)--(1,0)}$ | Custom Designed $7^{\text{th}}$ Order Transfer Function |
| $\tikz[baseline=-0.5ex]{\draw[color=mycolor2, line width=1.5pt](0,0)--(1,0)}$ | Type I Chebyshev Filter of Order $20$                   |

** $\mathcal{H}_\infty$ Synthesis - Comparison
\vspace{-1em}
*** Result                                                          :BMCOL:
:PROPERTIES:
:BEAMER_col: 0.6
:END:

\vspace{-2em}
#+attr_latex: :width 1.1\linewidth
[[file:figs/comp_fir_ligo_hinf.pdf]]

*** Comments                                               :B_column:BMCOL:
:PROPERTIES:
:BEAMER_col: 0.4
:END:
- FIR Filters: order 512
- $\mathcal{H}_\infty$ Filters: order 27

*** Conclusion                                            :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:

**** Conclusion                                                   :B_cbox:
:PROPERTIES:
:BEAMER_env: cbox
:BEAMER_opt: {blue}{}
:END:
Easy to use synthesis method of complementary filters
